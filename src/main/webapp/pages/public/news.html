<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
	<meta content="" name="description">
	<meta content="Mark Otto, Jacob Thornton, and Bootstrap contributors" name="author">
	<meta content="Jekyll v4.0.1" name="generator">
	<title>Blog Template · Bootstrap</title>

	<link href="../../css/bootstrap/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link href="../../css/blog.css" rel="stylesheet" type="text/css"/>

	<style>
		.bd-placeholder-img {
			font-size: 1.125rem;
			text-anchor: middle;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		@media (min-width: 768px) {
			.bd-placeholder-img-lg {
				font-size: 3.5rem;
			}
		}
	</style>
	<!-- Custom styles for this template -->
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:700,900" rel="stylesheet">
	<!-- Custom styles for this template -->
	<link href="blog.css" rel="stylesheet">
</head>
<body>
<div id="app">
	<div class="container">
		<header class="blog-header py-3">
			<div class="row flex-nowrap justify-content-between align-items-center">
				<div class="col-4 pt-1">
					<form class="form-inline my-2 my-lg-0">
						<input aria-label="Search" class="form-control mr-sm-2" id="search" placeholder="Search"
							   type="text">
						<a aria-label="Search" class="text-muted" v-on:click="selectByTitle()">
							<svg class="mx-3" fill="none" focusable="false" height="20" role="img" stroke="currentColor"
								 stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24"
								 width="20" xmlns="http://www.w3.org/2000/svg">
								<title>Search</title>
								<circle cx="10.5" cy="10.5" r="7.5"/>
								<path d="M21 21l-5.2-5.2"/>
							</svg>
						</a>
					</form>
				</div>
				<div class="col-4 text-center">
					<a class="blog-header-logo text-dark" href="#" style="font-weight: 600">Leng新闻网</a>
				</div>
				<div class="col-4 d-flex justify-content-end align-items-center">
					<a class="btn btn-sm btn-outline-secondary" href="login.html">登录</a>
				</div>
			</div>
		</header>

		<div class="nav-scroller py-1 mb-2">
			<nav class="nav d-flex justify-content-between">
				<a class="p-2 text-muted" href="#" v-on:click="click()">热点</a>
				<a class="p-2 text-muted" href="#" v-for="item in type"
				   v-html="item.typeName" v-on:click="updateNews(item.id)"></a>
			</nav>
		</div>
	</div>

	<main class="container" role="main">
		<div class="row">
			<div class="col-md-9 blog-main">
				<div class="row mb-2">
					<!-- 变量对象数组，获取数据 -->
					<div class="col-md-12" v-for="item in news" v-on:click="newsClick(item.id)">
						<div class="row no-gutters border rounded overflow-hidden flex-md-row mb-4 shadow-sm h-md-250 position-relative">
							<div class="col p-4 d-flex flex-column position-static">
								<strong class="d-inline-block mb-2 text-success"
										v-html="'发布时间：'+item.releaseTimeStr"></strong>
								<h3 class="mb-0" style="padding-bottom: 10px" v-html="item.title"></h3>
								<!--										<div class="mb-1 text-muted">Nov 11</div>-->
								<p class="mb-auto" v-html="item.introduction"></p>
								<h2 v-html="item.typeId"></h2>
								<a class="stretched-link"
								   v-bind:href="'http://localhost:8888/bysj01/pages/public/show.html?id='+item.id">阅读原文</a>
							</div>
							<div class="col-auto d-none d-lg-block">
								<svg aria-label="Placeholder: Thumbnail" class="bd-placeholder-img" focusable="false"
									 height="250"
									 preserveAspectRatio="xMidYMid slice" role="img" width="200"
									 xmlns="http://www.w3.org/2000/svg">
									<title>Placeholder</title>
									<rect fill="#55595c" height="100%" width="100%"/>
									<text dy=".3em" fill="#eceeef" x="50%" y="50%">Thumbnail</text>
								</svg>
							</div>
						</div>
					</div>
				</div>
			</div><!-- /.blog-main -->

			<aside class="col-md-3 blog-sidebar">
				<div class="p-4 mb-3 bg-light rounded">
					<h4 class="font-italic">公告</h4>
					<strong class="d-inline-block mb-2 text-success" v-html="'发布时间：'+notice.addTimeStr"></strong>
					<p class="mb-0" v-html="notice.notice"></p>
				</div>

				<div class="p-4">
					<h4 class="font-italic">活动</h4>
					<ol class="list-unstyled mb-0">
						<li v-for="item in activity"><a href="#"
														v-html="item.title" v-on:click="activity_show(item.id)"></a>
						</li>
					</ol>
				</div>
			</aside><!-- /.blog-sidebar -->

		</div><!-- /.row -->

	</main><!-- /.container -->

	<footer class="blog-footer">
		<p>Blog template built for <a href="https://getbootstrap.com/">Bootstrap</a> by <a
				href="https://twitter.com/mdo">@mdo</a>.</p>
		<p>
			<a href="#">Back to top</a>
		</p>
	</footer>
</div>
<script charset="utf-8" src="../../js/jquery-3.5.1.min.js" type="text/javascript"></script>
<script charset="utf-8" src="../../js/bootstrap/bootstrap.min.js" type="text/javascript"></script>
<script charset="utf-8" src="../../js/vue.min.js" type="text/javascript"></script>
<script src="../../layui/layui.all.js"></script>
<script type="text/javascript">
	let vm = new Vue({
		el: '#app',
		data: {
			news: {},
			type: {},
			notice: {},
			activity: {}
		},
		mounted: function () {
			let that = this;
			// 获取 文章
			$.ajax({
				url: 'http://localhost:8888/bysj01/news/selectByTitleAndStatus.do',
				type: "post",
				data: {page: 1, limit: 10, status: 3},
				dataType: "json",
				//    配置参数
			}).done(function (res) {
				that.news = res.data;
				//    以此类推
			}).fail(function () {
				console.log("请求失败");
			});
			// 获取分类
			$.ajax({
				url: 'http://localhost:8888/bysj01/type/selectByName.do',
				type: "post",
				data: {page: 1, limit: 10},
				dataType: "json",
				//    配置参数
			}).done(function (res) {
				that.type = res.data;
				//    以此类推
			}).fail(function () {
				console.log("请求失败");
			});
			// 获取公告
			$.ajax({
				url: 'http://localhost:8888/bysj01/notice/selectOne.do',
				type: "post",
				dataType: "json",
				//    配置参数
			}).done(function (res) {
				that.notice = res;
				//    以此类推
			}).fail(function () {
				console.log("请求失败");
			});
			// 获取活动
			$.ajax({
				url: 'http://localhost:8888/bysj01/activity/selectByStatus.do',
				type: "post",
				dataType: "json",
				//    配置参数
			}).done(function (res) {
				that.activity = res;
				//    以此类推
			}).fail(function () {
				console.log("请求失败");
			});
		},
		methods: {
			updateNews: function (id) {
				$.ajax({
					url: 'http://localhost:8888/bysj01/news/selectByTypeId.do',
					type: "post",
					data: {typeId: id},
					dataType: "json",
					success: function (d) {
						console.log(d);
						vm.news = d;
					}
				});
			},
			click: function () {
				$.ajax({
					url: 'http://localhost:8888/bysj01/news/selectByClick.do',
					type: "post",
					dataType: "json",
					success: function (d) {
						vm.news = d;
					}
				});
			},
			newsClick: function (id) {
				console.log(id);
				$.ajax({
					url: 'http://localhost:8888/bysj01/news/updateClick.do',
					type: "post",
					dataType: "json",
					data: {id: id},
					success: function (d) {
						console.log(d);
					}
				});
			},
			selectByTitle: function () {
				let title = $("#search").val();
				$.ajax({
					url: 'http://localhost:8888/bysj01/news/selectByTitleAndStatus.do',
					type: "post",
					data: {page: 1, limit: 10, title: title, status: 3},
					dataType: "json",
					//    配置参数
				}).done(function (res) {
					console.log(res);
					vm.news = res.data;
					//    以此类推
				}).fail(function () {
					console.log("请求失败");
				});
			},
			activity_show: function (id) {
				let layer = layui.layer;
				layer.open({
					type: 2,
					area: ['600px', '450px'],
					maxmin: true,
					content: 'http://localhost:8888/bysj01/pages/public/activity_show.html',
					success: function (layero, index) {
						let iframe = window['layui-layer-iframe' + index];
						iframe.child(id);
					}
				});
			}
		}
	});
</script>
</body>
</html>
